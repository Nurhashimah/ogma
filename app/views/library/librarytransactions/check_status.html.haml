- model_class = Librarytransaction
.page-header
  %h1= t('library.check.status')#, :default => model_class.model_name.human.pluralize
  
.row
  .col-md-3
    .btn-group.right{"data-toggle" => "buttons"}
      %button.btn.btn-default.btn-lgbtn#option_student{style: "width:90px;"}
        %input#option1{:name => "options", :type => "radio"}
          = (t 'people.student')
      %button.btn.btn-default.btn-lgbtn#option_staff{style: "width:90px;"}
        %input#option2{:name => "options", :type => "radio"}
          = (t 'people.staff')
  .col-md-6.staff_search{style: "display:none;"}
    = form_for :search, :url => { :action => "check_status" }, :html=>{:class => "form-horizontal", :role => "form", :style => 'padding: 0 30px 0 30px; margin-top: 0;' } do |f|
      .input-group
        = f.text_field :staff_name, :autofocus => true, :required => true, :class => 'form-control', :type => "input", :id => "input1", placeholder: (t 'staff.name')
        %span.input-group-btn
          = f.submit (t 'search'), :class => "btn btn-primary", style: "width:80px;"
      %span.help-block.small= (t 'library.check.search')
      
  .col-md-6.student_search{style: "display:none;"}
    = form_for :search, :url => { :action => "check_status" }, :html=>{:class => "form-horizontal", :role => "form", :style => 'padding: 0 30px 0 30px; margin-top: 0;' } do |f|
      .input-group
        = f.text_field :student_icno, :autofocus => true, :required => true, :class => 'form-control', :type => "input", :id => "input1", placeholder: "IC Starts with"
        %span.input-group-btn
          = f.submit (t 'search'), :class => "btn btn-primary", style: "width:80px;"
      %span.help-block.small= (t 'library.check.search')

          
          
.row.student_search{style: "display:none;"}

.row
  %hr
  .col-md-9.col-md-offset-1
    - if (@staff_name != nil || @student_ic != nil) && @librarytransactions == []
      %h4 Results
      %p no transactions
    - elsif @staff_name != nil && @librarytransactions != []
      %h4 Results
      - @librarytransactions.group_by(&:staff).each do |staff, transactions|
        - if transactions.length < 5; @panel = "panel-info"; else @panel = "panel-danger"; end
        .panel{:class => @panel}
          .panel-heading
            = staff.name
            %span.badge.right= transactions.length
          .panel-body
            - for transaction in transactions
              .col-sm-1= transaction.try(:accession).try(:accession_no)
              .col-sm-9= link_to transaction.try(:accession).try(:book).try(:title), '#', class: "bogus"
              .col-sm-2
                - if transaction.returnduedate < Date.today.yesterday && transaction.returneddate.blank?
                  %span{style: "color:red;"}= transaction.returnduedate
                - else
                  %span= transaction.returnduedate
          - if @panel == "panel-info"
            .panel-footer
              .right= link_to "Add", new_library_librarytransaction_path
              text
              
    - elsif @student_ic != nil && @librarytransactions != []
      %h4 Results
      - @librarytransactions.group_by(&:student).each do |student, transactions|
        - if transactions.length < 5; @panel = "panel-info"; else @panel = "panel-danger"; end
        .panel{:class => @panel}
          .panel-heading
            = student.name
            = student.icno
            %span.badge.right= transactions.length
          .panel-body
            - for transaction in transactions
              .col-sm-1= transaction.try(:accession).accession_no
              .col-sm-9= link_to transaction.try(:accession).try(:book).try(:title), '#', class: "bogus"
              .col-sm-2
                - if transaction.returnduedate < Date.today.yesterday && transaction.returneddate.blank?
                  %span{style: "color:red;"}= transaction.returnduedate
                - else
                  %span= transaction.returnduedate
          - if @panel == "panel-info"
            .panel-footer
              .right Add Link
              text
              
          
  
    

    
.row

%p{ :style => 'margin: 25px 0 30px 0' }
%small{style: "padding-top:13px;"}
    
