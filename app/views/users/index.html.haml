- model_class = User
.page-header
  %h1= t('user.list')#, :default => model_class.model_name.human.pluralize
  
.navbar.navbar-inverse{role: "navigation", style: "padding-right:40px;"}
  %ul.nav.navbar-nav.navbar-right
    %li= link_to content_tag(:li, fa_icon("search", text: (t 'actions.search'))), "#", class: "index_search_bar"
    %li= link_to content_tag(:li, fa_icon("print", text: (t 'actions.print'))), "#", class: "bogus"
= current_user.college.users.map(&:college_id)  
.row
  %table.table-striped.table-hover.ogma
    %thead
      %tr
        - if is_developer?
          %th{style: "width:8%;"}=(t 'user.college') 
        %th{style: "width:20%;"}= sort_link(@search, :email, (t 'user.email'))
        %th{style: "width:15%;"}= sort_link(@search, :keyword, (t 'user.userable_id'))
        %th{style: "width:17%;"}=(t 'user.position')+" / Unit"
        %th{style: "width:10%;"}= sort_link(@search, :userable_type, (t 'user.userable_type'))
        %th{style: "width:30%;"}= (t 'user.roles')
    %tbody
      = render "search_bar"
      - @user_by_type.each do |user_type, users| 
        = users.map(&:college_id)
        - for user in users
          %tr
            - if is_developer?
              %td=user.college.try(:code).try(:upcase)
            %td= link_to user.email, edit_user_path(user)
            %td=h user.userable.try(:staff_with_rank)
            %td
              = user.userable_type == "Staff" ? list_comma(user.userable.positions.pluck(:name)) : ""
              = user.userable_type == "Staff" && user.userable.positions.pluck(:unit).present? ? " / "+user.userable.positions.pluck(:unit).first : ""
            %td.centre
              - if user.userable_type == "Staff" 
                = (t 'staff.title') 
              - elsif user.userable_type == "Student"
                = (t 'student.title')
              - else
                =(t 'user.user_not_link_entity')
            %td=translated_list_comma(user.roles.pluck(:authname))
            /=list_comma(user.roles.pluck(:name))

  .right{style:"padding:0 30px; margin:0;"}= paginate @users, :theme => 'twitter-bootstrap-3'

