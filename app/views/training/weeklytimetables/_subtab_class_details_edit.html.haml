- @semester_subject_topic_list = Programme.find(@weeklytimetable.programme_id).descendants.where('ancestry_depth=? OR ancestry_depth=?',3,4).sort_by(&:combo_code)		
- @timeslot = @weeklytimetable.timetable_monthurs.timetable_periods.where('is_break is false')
- @timeslot2 = @weeklytimetable.timetable_friday.timetable_periods.where('is_break is false')



- @weeklytimetable.weeklytimetable_details.each do |xx|
  - if (xx.day2 == rowno && xx.time_slot2 == colno) || (xx.is_friday == true && rowno==0 && xx.time_slot == @count1+colno)
    /timeslot WITH VALUES
    - if xx.weeklytimetable_topic.ancestry_depth == 4 
      = xx.weeklytimetable_topic.parent.parent.code
      %br= xx.weeklytimetable_topic.parent.name
    - else
      = xx.weeklytimetable_topic.parent.code
      %br= xx.weeklytimetable_topic.name
    = xx.weeklytimetable_lecturer.name
    %br= xx.weeklytimetable_location.name
    = "(K)" if xx.lecture_method == 1
    = "(T)" if xx.lecture_method == 2
    = "(A)" if xx.lecture_method == 3
    %br  
    /thursday
    - if rowno==0 
      -timeslot2=0
      -timeslot=@count1+colno
      -ind = @count1*(4)+colno
      =hidden_field_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][id]", xx.id
      =hidden_field_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][timeslot]",timeslot				
    - else
      /sun-wed
      -timeslot2=colno
      -timeslot=0 
      -ind = @count1*(rowno-1)+colno-1
      =hidden_field_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][timeslot]",timeslot
      =hidden_field_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][timeslot2]",timeslot2

    /topic (sem-subject-topic)
    =select_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][topic]", options_from_collection_for_select(@semester_subject_topic_list, :id,:semester_subject_topic, xx.topic), :prompt=>(t 'helpers.prompt.select_sem_subject_topic')

    /lecturer_id
    =select_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][lecturer_id]", options_from_collection_for_select(Staff.joins(:positions).where('positions.name=?','Pengajar').sort_by(&:name), :id,:name, xx.lecturer_id), :prompt=>(t 'helpers.prompt.select_lecturer')
	
    /location
    =select_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][location]", options_from_collection_for_select(Weeklytimetable.location_list.sort_by{|x|x.name}, :id, :name, xx.location), :prompt=>(t 'helpers.prompt.select_location')
	
    /lecture method
    = select_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][lecture_method]", options_for_select(WeeklytimetableDetail::CLASS_METHOD,  xx.lecture_method), :prompt=> (t 'helpers.method.select_lecture_method')

    /weeklytimetable_details ID
    =text_field_tag "weeklytimetable[weeklytimetable_details_attributes][#{ind}][id]",xx.id
  
  /pending
  /- else
  /- if (xx.day2 != rowno && xx.time_slot2!=colno)
  /rowno
  /=rowno
  /colno
  /=colno
  /=xx.day2.nil?
    
