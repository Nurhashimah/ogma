- model_class = LessonPlan
.page-header
  %h1= t('training.lesson_plan.title')
  
.navbar.navbar-inverse{role: "navigation", style: "padding-right:40px;"}
  %ul.nav.navbar-nav
    %li= link_to content_tag(:li, fa_icon("asterisk", text: (t 'actions.new'))), new_training_lesson_plan_path
  %ul.nav.navbar-nav.navbar-right
    %li.toga= link_to content_tag(:li, fa_icon("search", text: (t 'actions.search'))), "#", class: "toga"
    %li= link_to  (fa_icon "file-pdf-o", text: (t 'print')),  lessonplan_listing_training_lesson_plans_path(params.merge(format: 'pdf' ))

.row.filter{style: "display:none;"}
  .col-md-2
    
.row
  %table.table-striped.table-hover.ogma
    %thead
      %tr
        %th{width: '14%'}= sort_link(@search, :lecturer, (t 'training.lesson_plan.lecturer'))
        %th{width: '3%'}= sort_link(@search, :intake, (t 'training.lesson_plan.intake'))
        %th{width: '3%'}= t 'training.lesson_plan.student_qty'
        - if current_user.college.code=="kskbjb"
          %th{width: '5%'}= t 'training.lesson_plan.year'
          %th{width: '5%'} Sem
        %th{width: '16%'}= sort_link(@search, :topic, (t 'training.lesson_plan.topic'))
        %th{width: '14%'}= sort_link(@search, :lecture_title, (t 'training.lesson_plan.lecture_title'))
        %th{width: '8%'}= sort_link(@search, :lecture_date, (t 'training.lesson_plan.lecture_date'))
        %th{width: '4%'}= t 'training.lesson_plan.start_time'
        %th{width: '4%'}= t 'training.lesson_plan.end_time'
        %th{width: '6%'}= sort_link(@search, :is_submitted, (t 'training.lesson_plan.is_submitted2'))
        %th{width: '6%'}= sort_link(@search, :hod_approved, (t 'training.lesson_plan.hod_approved3'))
        %th{width: '6%'}= sort_link(@search, :report_submit, (t 'training.lesson_plan.report_submit2'))
        %th{width: '6%'}= sort_link(@search, :report_endorsed, (t 'training.lesson_plan.report_endorsed2'))
        
    %tbody
    = render "index_search"
    
    - @lesson_plans.each do |lesson_plan|
      %tr
        %td
          - if lesson_plan.lessonplan_owner.rank_id? 
            = link_to lesson_plan.lessonplan_owner.staff_with_rank, training_lesson_plan_path(lesson_plan)
          - else
            = link_to lesson_plan.lessonplan_owner.name, training_lesson_plan_path(lesson_plan)
        %td=h lesson_plan.lessonplan_intake.name
        %td.centre=h lesson_plan.student_qty
        - if current_user.college.code=="kskbjb"
          %td=h lesson_plan.year
          %td=h lesson_plan.semester
        %td
          =h lesson_plan.schedule_item.try(:weeklytimetable_topic).try(:subject_list).to_s+"-"
          %b=lesson_plan.schedule_item.try(:render_class_method).try(:first)
        %td=h lesson_plan.lecture_title
        %td=h lesson_plan.college.code=='amsas' ? lesson_plan.try(:lecture_date).try(:strftime, '%d-%m-%Y') : lesson_plan.try(:lecture_date).try(:strftime, '%d %b %Y')
        %td=h lesson_plan.college.code=='amsas' ? lesson_plan.try(:start_time).try(:strftime, '%H:%M') : lesson_plan.try(:strftime, '%l:%M %p')
        %td=h lesson_plan.college.code=='amsas' ? lesson_plan.try(:end_time).try(:strftime, '%H:%M') : lesson_plan.try(:strftime, '%l:%M %p')
        %td=h lesson_plan.is_submitted? ? fa_icon('check') : fa_icon('times')
        %td
          =h lesson_plan.hod_approved? ? fa_icon('check') : fa_icon('times')
          =h lesson_plan.hod_rejected? ? "- Rejected" : ""
        %td=h lesson_plan.report_submit? ? fa_icon('check') : fa_icon('times')
        %td=h lesson_plan.report_endorsed? ? fa_icon('check') : fa_icon('times')

  .right{style:"padding:0 30px; margin:0;"}= paginate @lesson_plans, :theme => 'twitter-bootstrap-3'
 
:javascript
$(document).ready(function(){
  $('.toga').click(function() {
    $('.search_row').toggle(); 
  });
})

