/ Nav tabs
%ul.nav.nav-tabs
  %li.active= link_to  (t 'equery.result'), "#search", "data-toggle" => "tab"

/ display 
.tab-content{style:"padding-top:1em"}
  #search_details.tab-pane.active  
        
    /additional heading
    .col-md-8.col-md-offset-2
      %dl.dl-horizontal
        /:programme_id, :examtype, :subject_id, :examon, :exampaper
        
        - if examanalysissearch.programme_id.blank? && examanalysissearch.subject_id.blank? && examanalysissearch.examon.blank?
          %div.result-all=t 'equery.examanalysis.list_all'
        - else
          %div.result-search=t 'equery.search_by'
            
        %br
                   
        - unless examanalysissearch.programme_id.blank?
          %dt=(t 'equery.examanalysis.programme_id')
          %dd=Programme.find(examanalysissearch.programme_id).programme_list

        - unless examanalysissearch.subject_id.blank?
          %dt=(t 'equery.examanalysis.subject_id')
          %dd=Programme.find(examanalysissearch.subject_id).subject_list
          
        - unless examanalysissearch.examon.blank?
          %dt=(t 'equery.examanalysis.examon')
          %dd=examanalysissearch.examon.strftime('%d-%m-%Y')
        
        - if examanalysissearch.programme_id.blank? && examanalysissearch.subject_id.blank? && examanalysissearch.examon.blank?
        - else
          .col-md-12
            .col-md-8
              %hr
          
        %dt=(t 'equery.total')
        %dd=examanalysissearch.examanalyses.count==0 ? examanalysissearch.examanalyses.count : examanalysissearch.examanalyses.count.to_s+" "+(t 'records')

    /display result
    .col-md-10.col-md-offset-1
      %br
      - if examanalysissearch.examanalyses.count > 0
        .right= link_to (fa_icon "print", text: (t 'equery.print_result')), examanalysis_list_exam_examanalyses_path(format: 'pdf', ids: examanalysissearch.examanalyses.pluck(:id))     
        %table.table.table-bordered.table-condensed.table-hover.equery
          %head
            %tr.info
              %th{width: '4%'} No
              %th{width: '20%'}=t('equery.examanalysis.programme_id')
              %th{width: '26%'}=t('equery.examanalysis.subject_id')
              %th{width: '10%'}=t('equery.examanalysis.examon')
              %th{width: '20%'}=t('equery.examanalysis.examtype')
              %th.centre{width: '6%'}=t('equery.examanalysis.passed')
              %th.centre{width: '6%'}=t('equery.examanalysis.failed')
              %th.centre{width: '8%'}=t('equery.view')
          - cnt=0
          %body
            - examanalysissearch.examanalyses.group_by{|x|x.exampaper.subject.root}.each do |programme, examanalyses|
              /- if @is_admin
              /  %tr.info
              /    %th.centre.group{colspan: 8}
              /      %span=programme.programme_list
              - for examanalysis in examanalyses.sort_by{|x|x.exampaper.exam_on}
                %tr
                  %td=cnt+=1
                  %td=examanalysis.exampaper.subject.root.programme_list
                  %td
                    =examanalysis.exampaper.subject.subject_list
                    .small.text-grey="(#{(t 'training.programme.module')} : #{examanalysis.exampaper.subject.parent.name})"
                  %td.centre=examanalysis.exampaper.exam_on.strftime('%d-%m-%Y')
                  %td=examanalysis.exampaper.render_full_name
                  %td.centre=examanalysis.total_passed
                  %td.centre=examanalysis.total_failed
                  - @examanalysis=examanalysis
                  %td.centre= link_to (fa_icon "file-pdf-o", text: (t 'equery.examanalysis.analysis')), questionanalysis_list_exam_examanalyses_path(id: examanalysis.id, format: "pdf")
                 
            
      .right{style:"padding: 0 10px; margin:0;"}= paginate examanalyses, :theme => 'twitter-bootstrap-3', :pagination_class => 'pagination-sm'
