/ Nav tabs
%ul.nav.nav-tabs
  %li.active= link_to  (t 'equery.result'), "#search", "data-toggle" => "tab"

/ display 
.tab-content{style:"padding-top:1em"}
  #search_details.tab-pane.active  
        
    /additional heading
    .col-md-8.col-md-offset-2
      %dl.dl-horizontal
        /:intake_id, :subject_id, :student_id, :semester, :examdts, :examdte  
        
        - if examresultsearch.intake_id.blank? && examresultsearch.semester.blank? && examresultsearch.examdts.blank? && examresultsearch.examdte.blank?
          %div.result-all=t 'equery.examresult.list_all'
        - else
          %div.result-search=t 'equery.search_by'
            
        %br
                   
        - unless examresultsearch.intake_id.blank?
          %dt=(t 'equery.examresult.programme_id')
          %dd=examresultsearch.college.code=='amsas' ? Intake.find(examresultsearch.intake_id).siri_programmelist : Intake.find(examresultsearch.intake_id).programmelist_group_intake

        - unless examresultsearch.semester.blank?
          %dt Semester
          %dd=examresultsearch.semester
          
        - unless examresultsearch.examdts.blank?
          %dt=(t 'equery.examresult.examdts')
          %dd=examresultsearch.examdts.strftime('%d-%m-%Y')
          
        - unless examresultsearch.examdte.blank?
          %dt=(t 'equery.examresult.examdte')
          %dd=examresultsearch.examdte.strftime('%d-%m-%Y')

        - if examresultsearch.intake_id.blank? && examresultsearch.semester.blank? && examresultsearch.examdts.blank? && examresultsearch.examdte.blank?
        - else
          .col-md-12
            .col-md-8
              %hr
          
        %dt=(t 'equery.total')
        %dd=examresultsearch.examresults.count==0 ? examresultsearch.examresults.count : examresultsearch.examresults.count.to_s+" "+(t 'records')

    /display result
    .col-md-10.col-md-offset-1
      %br
      - if examresultsearch.examresults.count > 0
        - @examresults=examresultsearch.examresults
        - if examresultsearch.student_id!=1
          .right= link_to (fa_icon("print", text: (t 'actions.print'))), examresult_list_exam_examresults_path(@examresults, format: 'pdf')
        %table.table.table-bordered.table-condensed.table-hover.equery
          %head
            
          %body
            - examresultsearch.examresults.group_by{|x|x.intake_id}.each do |result_intake, examresults|
              %tr.info
                - if current_user.college.code=='amsas'
                  - colspanning=9
                - else
                  - colspanning=10
                %th.centre{colspan: "#{colspanning}"}=examresultsearch.college.code=='amsas' ? (t 'equery.examresult.intake')+Intake.find(result_intake).siri_name :  (t 'equery.examresult.intake')+Intake.find(result_intake).programme.programme_list
                - cnt=0
              %tr.info
                %th{width: '4%'} No
                %th{width: '56%', colspan: 4}=t('equery.examresult.programme')+" / Semester"
                %th.centre{width: '10%'}=t('equery.examresult.start')
                %th.centre{width: '10%'}=t('equery.examresult.end')
                %th.centre{width: '20%', colspan: 2}=t('equery.links')
              - for examresult in examresults
                %tr
                  %td=cnt+=1
                  %td{colspan: 4}
                    =Intake.find(examresult.intake_id).programme.programme_list
                    =" / "+examresult.render_semester.to_s
                  %td.centre=examresult.examdts.try(:strftime, '%d-%m-%Y')
                  %td.centre=examresult.examdte.try(:strftime, '%d-%m-%Y')
                  %td.centre{colspan: 2}=link_to (t 'equery.examresult.exam_result'), results_exam_examresults_path(id: examresult.id, format: "pdf")
                - if examresultsearch.student_id==1
                  %tr.warning
                    %th
                    %th{width: '4%'} No
                    %th{width: '10%'}=examresultsearch.college.code=='amsas' ? (t 'equery.examresult.mykad_no') : (t 'equery.examresult.matrix_no')
                    %th{width: '26%'}=t('equery.examresult.student')
                    %th{width: '6%'}=t('equery.examresult.total')
                    %th.centre PNGS
                    %th.centre PNGK
                    %th.centre{width: '8%'} Status
                    %th.centre{width: '12%'}=t('equery.links')
                  - cnt2=0
                  - for examslip in examresult.resultlines
                    %tr
                      %td
                      %td=cnt2+=1
                      %td=examresultsearch.college.code=='amsas' ? (formatted_mykad(examslip.student.icno)) : examslip.student.matrixno
                      %td=examresultsearch.college.code=='amsas' ? examslip.student.student_with_rank : examslip.student.name
                      %td=h examslip.total
                      %td=h examslip.pngs17
                      %td=h examslip.pngk 
                      %td=h examslip.render_status
                      %td.centre= link_to (t 'equery.examresult.exam_slip'), examination_slip_exam_examresults_path(id: examslip.id, format: "pdf")
                    
            
      .right{style:"padding: 0 10px; margin:0;"}= paginate examresults, :theme => 'twitter-bootstrap-3', :pagination_class => 'pagination-sm'
